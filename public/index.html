<html>

<head>
    <title>k7 docs (unofficial)</title>
    <style>
        body {
            font-family: Consolas, monospace;
            font-size: 13px;
        }
        pre {font-family: Consolas, monospace}
        #detail pre {
            display: inline-block;
            border: 1px solid black;
            padding: 0.25em;
            margin: 0;
            margin-bottom: 0.5em;
            background-color: #9e9e9e1c;
        }
        code {
            background-color: #9e9e9e1c;
            border: 1px solid black;
            padding-left: 0.2em;
            padding-right: 0.2em;
        }
        h3 {padding-top: 0.5em; margin-top: 0.5em}
        h4 {margin-top: 0.5em}
        ul {padding-left: 1.5em}

        @media screen and (min-width: 800px) {
            body {
                display: flex;
                height: 100%;
                margin: 0;
            }
            #index {
                padding-left: 1em;
                padding-right: 1em;
                overflow-y: scroll;
            }
            #detail {
                margin-left: 1em;
                overflow-y: scroll;
                flex-grow: 1;
            }
        }
        @media screen and (max-width: 800px) {
            #index {
                border-bottom: 1px solid black;
            }
        }

    </style>
</head>

<body>

    <div id="index">

        <pre>$k [-p 1234] [f.k]                           .z.i(pid) .z.x(arg) .z.e(env)         
                                                                                   
Verb                       Adverb                Noun            Atom List         
:  assign                  '  each               char  " ab"       `c `C           
+  add         flip        /  over               name  ``a`b       `n `N           
-  subtract    negate      \  scan               int   Ø 0 2       `i `I          
*  multiply    first       ': eachprior peach    float ø 2.3 π ∞   `f `F       
%  divide      inverse     /: eachright join|sv  time 12:34:56.789 `t .z.t         
&  min|and     where       \: eachleft split|vs  date 2019-06-28   `D .z.D         
|  max|or      reverse                                                             
<  less        up          System                list (2;3.4;`c)   `               
>  more        down        0: read/write line    dict [a:2;b:`c]   `a `A table     
=  equal       group       1: read/write byte    expr :32+9*f%5    `0              
~  match       not         2: read/write data    func {(+/x)%#x}   `1..9           
!  mod|dict    key|enum    3: conn/set (.z.ms)                                     
,  catenate    enlist      4: http/get (.z.mg)   \\       exit                     
^  except      null                              \l f.k   load                     
#  take        count       #[t;c;b[;a]] select   \t[:n] x time/milli               
_  drop        floor       _[t;c;b[;a]] update   \u[:n] x trace/micro              
?  draw|find   rand|uniq   ?[x;i;f[;y]] splice   \v [d]   vars                     
@  index       type        @[x;i;f[;y]] amend    \f [d]   fns                      
.  apply       value       .[x;i;f[;y]] dmend    \cd [d]  get[set]dir              
$  pad|cast    string      $[c;t;f] conditional  \lf [x]  files \lc chars \ll lines
if[c;..];while[c;..]                                                               
                                                                                   
generate: !i i? -i?(deal) ?i ?-i(normal)                                           
datetime:YMDHRSTUV + duration:ymdhrstuv; T:.z.D+.z.t; 2019-06-28+2m; dayofweek:7!  
`year`month`date`hour`minute`second`millisecond`microsecond`nanosecond             
                                                                                   
table: select delete update; by from where; [x]key [x]asc [x]dsc                   
aggr: count first last min max [x]sum [x]avg [x]var [x]dev [x]med                  
math: abs [x]log [x]exp sqrt sin cos                                               
util: in within bin like find [x]prm                                               
                                                                                   
2way: ``j`k`csv`b64`hex`aes  e.g. json: `j?`j@`a`b!2 3                             
1way:  `p`m`crc`sha`rip`bad  e.g. hash: `sha@"crypto"                              
                                                                                   
K:key k:key`k1     / public private                                                
K key k key"hi"    / verify sign</pre>

<hr>

<p><a href="#shakti-python">Notes on shakti-python</a></p>

<p>Communities:</p>
<ul>
    <li><a href="https://groups.google.com/forum/#!forum/shaktidb">shakti google group</a> (official - for 'how to' queries)</li>
    <li><a href="https://chat.stackexchange.com/rooms/90748/the-k-tree">the k tree</a> <br>  write access: email <code>".@acegiklmnort"@7 13 12 4 4 0 10 5 10 1 5 9 2 6 8 0 3 11 9</code></li>
    <li><a href="https://www.reddit.com/r/apljk/">r/apljk</a></li>
</ul>

<p><a href="https://shakti.com/tutorial">Official k7 tutorial</a></p>

<p><a href="https://gitlab.com/k7contrib/docs/">Contribute to these docs</a></p>

</div>

<div id="detail">
    <!-- <h3 id="template"></h3><pre></pre> -->
    <h3 id="group">Group</h3>
    <p>With a list, get back the indices at which each unique element appears:
    <pre> ="abracadabra"
a|0 3 5 7 10
b|1 8       
c|,4        
d|,6        
r|2 9</pre>
    <p>With a positive integer, generate an identity matrix:</p>
    <pre> =3
1 0 0
0 1 0
0 0 1</pre>
    <h3 id="enum">Enum</h3><pre> !3
0 1 2
 !2 3
(0 0 0 1 1 1;0 1 2 0 1 2)</pre>
    <h3 id="key">Key</h3>
    <pre> ! [a:1;b:2]
`a`b</pre>
    <h3 id="join">Join</h3>
    <pre> "-"/:("abc";"def")
"abc-def"</pre>
    
    <h3 id=".z.D">Current date <code>.z.D</code></h3>
    <pre>.z.D / 2019-04-02</pre>
    
    <h3 id=".z.t">Current time <code>.z.t</code></h3>
    <p>Greenwich Mean Time.</p>
    
    <pre>.z.t / 11:18:14.857</pre>
    
    <h3 id="table">Tables</h3>
    <pre>t: ([a:1;b:2];[a:3;b:4])   / Row-wise
u: +`a`b !    (1 3;2 4)    / Col-wise (flipped dict)
v:  `a`b ! /: (1 2;3 4)    / Row-wise, but de-duplicate headers using eachright

/ The tables match:
t~u
t~v

/ Break row-wise over multiple lines:
w: ([a:1;b:2]
    [a:3;b:4])

t~w

/ Break row-wise (condensed row format) over multiple lines:
x: `a`b!/:(1 2
           3 4)

t~x</pre>

<p>Make one or more columns key columns:</p>

<pre> t: ([a:1;b:2;c:3];[a:4;b:5;c:6])
 tk: `a`c key t
 tk
a c| b
- -| -
1 3| 2
4 6| 5</pre>

    <h3 id="expr">exprs</h3>
    <p>WIP. See <a href="https://groups.google.com/d/msg/shaktidb/5N6VjsOBjoA/GjFgeP4yDAAJ">this forum post</a>.</p>

    <h3 id=".z.f">Recursion <code>.z.f</code></h3>
    <p>Use in a function definition to refer to the current function.</p>
    <pre> factorial: {$[x<2;1;x*.z.f[x-1]]}
 factorial 4
24
/ Better: {*/1+!x}</pre>

    <h3 id="asc">Sort ascending <code>asc</code></h3>

    <pre> asc "abracadabra"
"aaaaabbcdrr"</pre>

    <h3 id="dsc">Sort descending <code>dsc</code></h3>

    <pre> dsc "abracadabra"
"rrdcbbaaaaa"</pre>

    <h3 id="within">Within</h3>

    <pre> `p within `A`z
1
 `p within `A`Z
0</pre>

    <h3 id="2way">Two-way conversions</h3>

    <p>Convert to with <code>`x@data</code> or <code>`x data</code>, where `x is the relevant name.</p>

    <p>Convert from with <code>`x?serialdata</code>.</p>

    <h4>Binary <code>`</code></h4>
    <pre> ` "a"
0x0161
 ` `a
0x0f6100
 ` 10
0x070a000000</pre>

    <h4>JSON <code>`j</code></h4>

    <pre> `j ([a:1;b:2];[a:"x";b:`z])
"[{\"a\":1,\"b\":2},{\"a\":\"x\",\"b\":\"z\"}]"</pre>

    <h4>KSON <code>`k</code></h4>

    <pre> `k 2*!3
"0 2 4"
 `k ([a:1;b:2];[a:"x";b:`z])
"+[a:(1;\"x\");b:(2;`z)]"</pre>

    <h3 id="1way">One-way conversions</h3>

    <h4>Parse <code>`p</code></h4>
    <pre> `p "5*!3"
*     
5     
(!:;3)</pre>

    <h4>Matrix display <code>`m</code></h4>

    <pre>d: 1 2 3
 d
1 2 3
 `m d
1
2
3</pre>

<h3 id="shakti-python">shakti-python</h3>

<!--<p>Install instructions for Ubuntu 18.04:</p>

<ul>
    <li>Get Miniconda</li>
    <li>Run <code>conda install -c shaktidb shakti-python</code></li>
    <li>Press 'Python' at the prompt</li>
</ul>-->

<p>Type <code>help('shakti')</code> at the Python prompt to view the package help.</p>

<pre>>>> import shakti
>>> 
>>> # Execute k commands:
... a = shakti.k("!3")
>>> a
k('!3')
>>> a.  # press tab twice for auto-completion (have truncated output)
a.append(    a.cat(       a.distinct(  a.eq(        a.first(     a.group( ...
a.apply(     a.clear(     a.dsc(       a.eval(      a.flip(      a.iasc(  ...
a.asc(       a.count(     a.enlist(    a.extend(    a.floor(     a.idesc( ...
>>> # shakti module functions can take Python objects directly:
... a.cat((1, 2, 3))
k('0 1 2 1 2 3')
>>> b = a.cat((1, 2, 3)).where
>>> b
k('1 2 2 3 4 4 5 5 5')
>>> sum(b)
k('31')
>>>
>>> # User-facing module API:
... shakti.__all__
['q', 'k', 'o', 'flip', 'neg', 'sqrt', 'enum', 'parse', 'where', 'reverse',
'count', 'first', 'last', 'sum', 'min', 'max', 'avg', 'var', 'iasc', 'idesc',
'group', 'not_', 'enlist', 'null', 'floor', 'string', 'distinct', 'type_',
'eval_', 'apply', 'at', 'rand', 'find', 'cast', 'take', 'shape', 'match',
'cat', 'drop', 'cut', 'log', 'exp', 'sin', 'cos', 'first', 'last', 'error',
'Ø', 'ø', 'inf', 'show']
>>> 
>>> # Convert Python objects to k:
... shakti.o(range(10))
k('!10')
>>> # o is equivalent to k's identity function:
... shakti.o == shakti.k('::')
True
>>>
>>> # Add globals to k:
... shakti.q.a = [1,2,3]
>>> shakti.k("a*2")
k('2 4 6')
>>> shakti.q.a * 2
k('2 4 6')
>>>
>>> # REPL: shakti.k_repl(), or just...
... /
 +/ 1 2 3
6
 \\
>>></pre>

<p>shakti-python also lets you do some things that k doesn't:</p>
<ul>
    <li><a href="https://groups.google.com/d/msg/shaktidb/etsXDI9J4o4/HmefTXyBAwAJ">Delete globals</a> (at your peril!)</li>
    <li><a href="https://groups.google.com/d/msg/shaktidb/lQ3XSvFPDhw/DOlmmFgHDAAJ">Catch errors</a></li>
</ul>

<script>

    const raw_elem = document.getElementById("index")
    function makeLink(word) {
        return "<a href=\"#" + word + "\">" + word + "</a>"
    }

    links = ["group", "enum", "key", "join", "table", ".z.D", ".z.t", ".z.f", "expr", "asc", "dsc", "within", "1way", "2way"]

    for (let i in links) {
        const w = links[i]
        raw_elem.innerHTML = raw_elem.innerHTML.replace(w, makeLink(w))
    }
    
</script>

</body>

</html>
